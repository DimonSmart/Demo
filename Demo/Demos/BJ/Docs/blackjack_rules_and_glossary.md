# Правила и терминология Blackjack

Документ описывает правила, которые реализованы на странице игры Blackjack, а также словарь терминов, используемых в коде и документации. Цель — обеспечить единообразие терминов при разработке автоигрока и построении таблицы стратегии.

## 1. Правила симуляции

- **Колода и шуз.** Игра использует абстракцию `Shoe`: шуз собирается из одной или нескольких стандартных 52-карточных колод без джокеров. Перетасовка выполняется перед стартом шуза.
- **Начальная раздача.** Игрок и дилер получают по две карты. Первая карта дилера открыта (upcard), вторая остаётся закрытой (hole card).
- **Blackjack игрока.** Комбинация из туза и десятиочковой карты на стартовой руке называется *Blackjack* (также встречается термин *natural blackjack*). Такая рука немедленно завершается выплатой, если дилер не имеет собственного Blackjack.
- **Последовательность ходов игрока.** Пока раунд не завершён и у руки меньше 21 очка, игрок может брать карту (`Hit`), останавливаться (`Stand`), удваивать ставку (`Double Down`), делить пару (`Split`) или сдавать руку (`Surrender`) — в зависимости от ограничений ниже. Для автоматизированной таблицы решения вычисляются на основании суммы руки (жёсткой, мягкой или пары) и открытой карты дилера.
- **Ход дилера.** После завершения всех рук игрока дилер вскрывает закрытую карту и добирает до жёстких 17 включительно. На мягких 17 дилер также останавливается. Дилер не делает `Hit`, если рука достигла 17 или больше.
- **Удвоение ставки.** `Double Down` разрешён на любых стартовых двух картах, в том числе после `Split`. После удвоения игрок автоматически получает ровно одну дополнительную карту и переходит в `Stand`.
- **Сплит.** Игрок может разделить пару до четырёх рук (три сплита). Каждая новая рука получает одну карту. Для тузов доступность добора определяется флагом `CanHitAfterSplitAces`.
- **Сдача.** `Surrender` разрешён только на стартовой руке до получения третьей карты. Это «late surrender»: ставка возвращается наполовину, если дилер не выигрывает Blackjack после открытия hole card.
- **Выплаты и исходы.** Победившая рука оплачивается 1:1, ничья (`Push`) возвращает ставку, проигрыш списывает полную ставку. Blackjack обычно оплачивается 3:2, но текущая реализация использует коэффициент 1:1. Страховка и побочные ставки отсутствуют.
- **Завершение раунда.** Рука «сгорает» при наборе более 21 очка (`Bust`). После завершения всех рук результаты фиксируются, баланс обновляется, затем может стартовать следующая партия.

## 2. Типы рук и оценка сумм

- **Жёсткая сумма (Hard Total).** Сумма очков руки без гибкого тузового значения. Если туз считается как 1, рука жёсткая. Пример: 10+6=16 — жёсткая рука.
- **Мягкая сумма (Soft Total).** Сумма очков, где хотя бы один туз считается как 11, не приводя к перебору. Пример: A+6=17 — мягкая рука. Мягкая рука автоматически превращается в жёсткую, если добор карты вызывает перебор при значении туза 11.
- **Пара (Pair).** Стартовые две карты одинакового ранга, включая любые десятиочковые карты (10, J, Q, K). Такие руки рассматриваются в таблице стратегии как кандидаты на `Split`.

## 3. Результаты и сравнение с дилером

- **Win / Loss / Push.** После завершения раздачи рука игрока сравнивается с рукой дилера. Выше — победа (`Win`), ниже — поражение (`Loss`), равенство — `Push`.
- **Blackjack дилера.** Если у дилера Blackjack, все руки игрока проигрывают, кроме собственных Blackjack (результат — `Push`). Сдача перед Blackjack дилера приводит к потере половины ставки.
- **Bust.** Рука с суммой более 21 очка мгновенно проигрывает, независимо от дальнейших действий дилера.

## 4. Словарь терминов

| Термин | Описание |
| --- | --- |
| **Blackjack** | Стартовая комбинация из туза и десятиочковой карты (также «натуральный блэкджек»). В документации рекомендуется использовать термин «Blackjack», избегая обобщённого «Natural». |
| **Bust** | Перебор: сумма очков превышает 21. |
| **Dealer Upcard** | Первая открытая карта дилера. Главный ориентир для таблицы стратегии. |
| **Dealer Hole Card** | Закрытая карта дилера, вскрывается перед ходом дилера. |
| **Hard Hand / Hard Total** | Жёсткая рука: все тузы считаются как 1. |
| **Soft Hand / Soft Total** | Мягкая рука: один туз считается как 11 без перебора. |
| **Split** | Разделение стартовой пары на две независимые руки с дополнительной ставкой. |
| **Double Down** | Удвоение ставки с получением ровно одной дополнительной карты. |
| **Surrender** | Добровольный отказ от руки с возвратом половины ставки. |
| **Hit** | Взять дополнительную карту. |
| **Stand** | Остановиться и не брать новые карты. |
| **Push** | Ничья между игроком и дилером; ставка возвращается. |
| **Shoe** | Набор из нескольких перетасованных колод, из которого раздаются карты. |
| **Strategy Table** | Таблица рекомендаций для каждой комбинации руки игрока и открытой карты дилера. Используется автоигроком. |

## 5. Использование терминов в коде и документации

- Для ссылок на стартовую комбинацию 21 очко используйте «Blackjack» или «натуральный блэкджек». Слово «Natural» без уточнения избегайте.
- Различайте `Hard` и `Soft` при описании стратегий: автоигрок полагается на эту типизацию для выбора действия.
- Когда описываете состояние дилера, используйте «upcard» и «hole card», чтобы подчеркнуть, какая карта известна игроку.
- При документировании правил указывайте, какие действия доступны: `Hit`, `Stand`, `Double Down`, `Split`, `Surrender`.

Документ предназначен для совместного использования с обзором [blackjack_ga_review.md](./blackjack_ga_review.md), где перечислены ограничения реализации и идеи по конфигурированию правил.
