@page "/bjgame"
@using Demo.Components
@using Demo.Demos.BJ
@using Demo.Demos.TSM.GeneralGenetic
<link rel="stylesheet" href="css/demos.css"/>

<PageTitle>Blackjack</PageTitle>

<div class="page-container casino-style">
    <div class="parameters-container">
        <h3>Blackjack</h3>
    </div>

    <GameInfo Game="GameInstance" />
    <PlayingHand Hand="GameInstance.DealerHand" />
    <PlayerHands Game="GameInstance" />
    <BlackJackGameControls Game="GameInstance" />
</div>

@code {
    private BlackjackGameBase GameInstance { get; set; } = null!;

    protected override void OnInitialized()
    {
        base.OnInitialized();

        var shoe = new Shoe(DeckFactory.CreateShuffledDecks(6, RandomProvider.Shared).Cards, redCardPosition: 100);
        GameInstance = new BlackjackGameWithPlayer(shoe);
        GameInstance.GameStateChanged += async (isDealerAction) =>
        {
            await HandleGameStateChanged(isDealerAction);
        };
    }

    private async Task HandleGameStateChanged(bool isDealerAction)
    {
        StateHasChanged();
        if (!isDealerAction) return;
        await Task.Delay(1000);
        await Task.Yield();
    }
}

<style>
    :root {
        --gap-size: 10px;
    }

    /* Overall casino-style page layout */
    .page-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: normal;
        height: calc(100vh - 56px - var(--gap-size));
        padding: 20px;
        background-image: radial-gradient(circle, #0d521d, #096a2b, #046d31);
        background-size: cover;
    }

    /* Styled header */
    h3 {
        font-family: 'Carter One', cursive;
        color: #ffd700;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        letter-spacing: 1px;
    }

    /* Card display container */
    .card-display {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    /* Style the card elements */
    .card {
        box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.7);
        border-radius: 8px;
    }

    /* Parameters styling */
    .parameters-container {
        margin-bottom: var(--gap-size);
    }

    /* General text styling for a more luxurious feel */
    body {
        font-family: 'Roboto', sans-serif;
        color: white;
    }
</style>
